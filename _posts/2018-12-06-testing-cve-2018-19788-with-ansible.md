---
title: Testing CVE 2018-19788 with Ansible
---

So a [very simple expoit on polkit](https://access.redhat.com/security/cve/cve-2018-19788) has been found. There is not solution so far.

To test if your system is vulnerable, you can run [this Ansible role](http://galaxy.ansible.com/robertdebock/cve_2018_19788).

In my tests these were the results:
```
TASK [robertdebock.cve_2018_19788 : create a user] ******************************************************
ok: [fedora28]
ok: [centos6]
ok: [centos7]

TASK [robertdebock.cve_2018_19788 : execute a systemctl command as root] ********************************
changed: [centos7]
changed: [fedora28]
ok: [centos6]

TASK [robertdebock.cve_2018_19788 : execute a systemctl command as that user] ***************************
fatal: [centos6]: FAILED! => changed=false 
  msg: ''
...ignoring
changed: [centos7]
changed: [fedora28]

TASK [robertdebock.cve_2018_19788 : test if user can manage service] ************************************
fatal: [fedora28]: FAILED! => changed=false 
  assertion: execute_user is not succeeded
  evaluated_to: false
  msg: users can manage services
ok: [centos6] => changed=false 
  msg: All assertions passed
fatal: [centos7]: FAILED! => changed=false 
  assertion: execute_user is not succeeded
  evaluated_to: false
  msg: users can manage services
```

As you can see both Fedora-28 and CentOS-7 are vulenerable...
