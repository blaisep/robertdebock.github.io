---
title: Testing CVE 2018-19788 with Ansible
---

# Testing CVE 2018-19788 with Ansible

So a [very simple exploit on polkit](https://access.redhat.com/security/cve/cve-2018-19788) has been found. There is not solution so far.

To test if your system is vulnerable, you can run [this Ansible role](http://galaxy.ansible.com/robertdebock/cve_2018_19788).

A simple playbook that includes a few roles:

```yaml
---
- name: test cve 2018 19788
  hosts: all
  gather_facts: no
  become: yes

  roles:
    - robertdebock.bootstrap
    - robertdebock.update
    - robertdebock.cve_2018_19788
```

And a piece of altered-for-readability code from the role:

```yaml
- name: create a user
  user:
    name: cve_2018_19788
    uid: 2147483659

- name: execute a systemctl command as root
  service:
    name: chronyd
    state: started
```

In my tests these were the results: (snipped, only kept the interesting part)

```text
TASK [robertdebock.cve_2018_19788 : test if user can manage service] **********************************************************************************************************************************************
fatal: [fedora28]: FAILED! => changed=false 
  assertion: execute_user is not succeeded
  evaluated_to: false
  msg: users can manage services
fatal: [fedora29]: FAILED! => changed=false 
  assertion: execute_user is not succeeded
  evaluated_to: false
  msg: users can manage services
ok: [centos6] => changed=false 
  msg: All assertions passed
fatal: [centos7]: FAILED! => changed=false 
  assertion: execute_user is not succeeded
  evaluated_to: false
  msg: users can manage services
```

So for now these distributions seem vulnerable, even after an update:
- Fedora 28
- Fedora 29
- CentOS 7
